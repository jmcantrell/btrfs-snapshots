#!/usr/bin/env bash

# Show that an error is reported when the profile does not exist.

set -eu

. "$LIB_DIR"/init.sh
. "$TESTS_LIB_DIR"/init.sh

profile_name=bogus
profile_file=$ETC_DIR/profile.d/$profile_name.conf

stderr_lines=(
    "$(printf "ERROR: $TEXT_PROFILE_NOT_EXIST" "$profile_name")"
    "$(printf "ERROR: $TEXT_PROFILE_LOAD_FAILED" "$profile_file")"
)

printf -v stderr "%s\n" "${stderr_lines[@]}"

for action in create prune; do
    assert_failure assert_stderr "$stderr" \
        btrfs-snapshots -p "$profile_name" "$action"
done
