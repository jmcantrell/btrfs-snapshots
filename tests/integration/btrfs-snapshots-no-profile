#!/usr/bin/env bash

# Show that an error is reported when the profile does not exist.

set -eu

. "$LIB_DIR"/init.sh
. "$TESTS_LIB_DIR"/init.sh

profile_dir=$TEMP_DIR
profile_name=bogus

printf -v message "%s\n" \
    "ERROR: $(format "$TEXT_PROFILE_NOT_EXIST" PROFILE="$profile_name")" \
    "ERROR: $(format "$TEXT_PROFILE_FAILED" PROFILE="$profile_dir/$profile_name.conf")"

export BTRFS_SNAPSHOTS_PROFILE_DIR=$profile_dir

for action in create prune; do
    assert_failure assert_stderr "$message" btrfs-snapshots -p "$profile_name" "$action"
done
